<!doctype html>
<html lang='en'>
      <head>
	<title>my walking directions</title>
		
		<link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:400,700,300' rel='stylesheet' type='text/css'>   <link rel='stylesheet' href='googledirections.css' />
		
		<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
		<script type="text/javascript">
		  var directionDisplay;
		  var directionsService = new google.maps.DirectionsService();
		  function initialize() {
		    var latlng = new google.maps.LatLng(51.523137, -0.087035);
		    directionsDisplay = new google.maps.DirectionsRenderer();
		    var myOptions = {
		      zoom: 14,
		      center: latlng,
		      mapTypeId: google.maps.MapTypeId.ROADMAP,
		      mapTypeControl: false
		    };
		   	// if you take out what is under var map & var marker, the geocoding might not work any more
		    var map = new google.maps.Map(document.getElementById("map_canvas"),myOptions);
		    directionsDisplay.setMap(map);
		    directionsDisplay.setPanel(document.getElementById("directionsPanel"));
		    var marker = new google.maps.Marker({
		      position: latlng, 
		      map: map, 
		      title:"My location"
		    }); 
		  }
		  function calcRoute() {
		    var start = "51.523137, -0.087035";
		    var end = document.getElementById("routeEnd").value;
		    var request = {
		      origin:start,
		      destination:end,
		      travelMode: google.maps.DirectionsTravelMode.WALKING
		    };
		    directionsService.route(request, function(response, status) {
				      if (status == google.maps.DirectionsStatus.OK) {
				        directionsDisplay.setDirections(response);
				      }
				      if (status == 'ZERO_RESULTS') {
					  alert('No route could be found between the origin and destination.');
					} else if (status == 'UNKNOWN_ERROR') {
					  alert('A directions request could not be processed due to a server error. The request may succeed if you try again.');
					} else if (status == 'REQUEST_DENIED') {
					  alert('This webpage is not allowed to use the directions service.');
					} else if (status == 'OVER_QUERY_LIMIT') {
					  alert('The webpage has gone over the requests limit in too short a period of time.');
					} else if (status == 'NOT_FOUND') {
					  alert('At least one of the origin, destination, or waypoints could not be geocoded.');
					} else if (status == 'INVALID_REQUEST') {
					  alert('The DirectionsRequest provided was invalid.');         
					} else if (status == google.maps.DirectionsStatus.OK) {
					  directionsDisplay.setDirections(response);
					} else {
					  if (status == 'ZERO_RESULTS') {
					    alert("Could not calculate a route to or from one of your destinations.");
					  } else {
					    alert("There was an unknown error in your request. Requeststatus: "+status);
					  }
					}
			    });
			  }
		</script>

		<!-- opens print window and preview -->
		<!-- print only table body -->
		<!-- also needs to capture images and suppress list numbers -->

		<script>
		function printContent(className) {
    	var matchedElements = document.getElementsByTagName("tbody");
    	
    	var str = '';

    	for (var i = 0; i < matchedElements.length; i++) {
        	var str = str + matchedElements[i].innerHTML;
    		}

	    var newwin = window.open('', 'printwin', 'left=100,top=100,width=600,height=600');
	    newwin.document.write('<html>\n<head>\n');
	    newwin.document.write('<title>walking directions</title>\n');
	    newwin.document.write('<link href="http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:400,700,300" rel="stylesheet" type="text/css">\n');
	    newwin.document.write('<link rel="stylesheet" href="googledirections.css">\n');
	    newwin.document.write('<script>\n');
	    newwin.document.write('function chkstate(){\n');
	    newwin.document.write('if(document.readyState=="complete"){\n');
	    newwin.document.write('window.close()\n');
	    newwin.document.write('}\n');
	    newwin.document.write('else{\n');
	    newwin.document.write('setTimeout("chkstate()",2000)\n');
	    newwin.document.write('}\n');
	    newwin.document.write('}\n');
	    newwin.document.write('function print_win(){\n');
	    newwin.document.write('window.print();\n');
	    newwin.document.write('chkstate();\n');
	    newwin.document.write('}\n');
	    newwin.document.write('<\/script>\n');
	    newwin.document.write('</head>\n');
	    newwin.document.write('<body onload="print_win()">\n');
	    newwin.document.write(str);
	    newwin.document.write('</body>\n');
	    newwin.document.write('</html>\n');
	    newwin.document.close();
		}
		</script>

</head>

<body onload="initialize()">
	
	<main class='centre'>
		
		<h1>my walking directions</h1>
	
		<div id="map_canvas" style="width:400px; height:400px"></div>   
  		<span>your directions from Makers Academy:</span>
		  <form action="/directions" onsubmit="calcRoute();return false;" id="routeForm">
		    <input type="text" id="routeEnd" value="" placeholder="destination">
		    <input type="submit" value="calculate route" font-family="Yanone Kaffeesatz">
		  </form>
		  <input type="submit" value="print route" onclick="printContent('onlydirections');">
 
  
		  <div id="directionsPanel" class="onlydirections">
		  </div>
		  
	</main>

</body>

</html>